<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="color-scheme" content="light dark">
    <title>Piano Teacher</title>

    <!-- Links to bootstrap css, bootstrap icons css and my own css -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
    <link rel="stylesheet" type="text/css" href="./piano-teacher.css">
</head>

<body>
    <!-- Highlight bar for showing future notes to be pressed -->
    <div id="note-overlay" aria-hidden="true"></div> <!-- Where notes begin falling -->
    <!-- Hero -->
    <header class="hero">
        <div class="container">
          <div class="hero-content">
              <h1 class="hero-title">Piano Teacher</h1>
              <p class="hero-subtitle" id="autoplay-section">Learn, play, and enjoy the music.</p>
              <div class="hero-button">
                  <a href="#piano-section" class="btn btn-primary">Start playing</a>
              </div>
          </div>
          </div>
        <div class="hero-overlay"></div>
    </header>

    <!-- Count down from 5 once autoplay starts -->
    <div class="countdown" id="countdown" aria-live="polite">Staring in 5...</div>

    <!-- Main content -->
    <main class="main container py-5">
        <br><br><br><br><br><br><br id="piano-section"><br><br>
        <!-- Piano -->
        <section class="piano-card card shadow-sm">
        <div class="card-body position-relative piano-wrapper">

            <!-- Using an svg to display the piano -->
            <div class="piano-frame center">
            <svg id="piano" viewBox="0 0 854 116" role="img" aria-label="Piano keyboard" preserveAspectRatio="xMidYMid meet">
                <!-- Standard piano -->
                <g id="piano-standard">
                    <!-- White keys C2–B5 -->
                    <rect x="0" y="0" width="30" height="90" class="white-key" data-note="C2"/>
                    <rect x="30" y="0" width="30" height="90" class="white-key" data-note="D2"/>
                    <rect x="60" y="0" width="30" height="90" class="white-key" data-note="E2"/>
                    <rect x="90" y="0" width="30" height="90" class="white-key" data-note="F2"/>
                    <rect x="120" y="0" width="30" height="90" class="white-key" data-note="G2"/>
                    <rect x="150" y="0" width="30" height="90" class="white-key" data-note="A2"/>
                    <rect x="180" y="0" width="30" height="90" class="white-key" data-note="B2"/>

                    <rect x="210" y="0" width="30" height="90" class="white-key" data-note="C3"/>
                    <rect x="240" y="0" width="30" height="90" class="white-key" data-note="D3"/>
                    <rect x="270" y="0" width="30" height="90" class="white-key" data-note="E3"/>
                    <rect x="300" y="0" width="30" height="90" class="white-key" data-note="F3"/>
                    <rect x="330" y="0" width="30" height="90" class="white-key" data-note="G3"/>
                    <rect x="360" y="0" width="30" height="90" class="white-key" data-note="A3"/>
                    <rect x="390" y="0" width="30" height="90" class="white-key" data-note="B3"/>

                    <rect x="420" y="0" width="30" height="90" class="white-key" data-note="C4"/>
                    <rect x="450" y="0" width="30" height="90" class="white-key" data-note="D4"/>
                    <rect x="480" y="0" width="30" height="90" class="white-key" data-note="E4"/>
                    <rect x="510" y="0" width="30" height="90" class="white-key" data-note="F4"/>
                    <rect x="540" y="0" width="30" height="90" class="white-key" data-note="G4"/>
                    <rect x="570" y="0" width="30" height="90" class="white-key" data-note="A4"/>
                    <rect x="600" y="0" width="30" height="90" class="white-key" data-note="B4"/>

                    <rect x="630" y="0" width="30" height="90" class="white-key" data-note="C5"/>
                    <rect x="660" y="0" width="30" height="90" class="white-key" data-note="D5"/>
                    <rect x="690" y="0" width="30" height="90" class="white-key" data-note="E5"/>
                    <rect x="720" y="0" width="30" height="90" class="white-key" data-note="F5"/>
                    <rect x="750" y="0" width="30" height="90" class="white-key" data-note="G5"/>
                    <rect x="780" y="0" width="30" height="90" class="white-key" data-note="A5"/>
                    <rect x="810" y="0" width="30" height="90" class="white-key" data-note="B5"/>

                    <!-- C labels -->
                    <text x="15"   y="60" text-anchor="middle" class="label">C2</text>
                    <text x="225"  y="60" text-anchor="middle" class="label">C3</text>
                    <text x="435"  y="60" text-anchor="middle" class="label">C4</text>
                    <text x="645"  y="60" text-anchor="middle" class="label">C5</text>

                    <!-- Beginner labels -->
                    <text x="255" y="60" text-anchor="middle" class="label">D</text>
                    <text x="285" y="60" text-anchor="middle" class="label">E</text>
                    <text x="315" y="60" text-anchor="middle" class="label">F</text>
                    <text x="345" y="60" text-anchor="middle" class="label">G</text>
                    <text x="375" y="60" text-anchor="middle" class="label">A</text>
                    <text x="405" y="60" text-anchor="middle" class="label">B</text>

                    <!-- Black keys C2–B5 -->
                    <rect x="21"   y="0" width="18" height="46" rx="4" class="black-key" data-note="Cs2"/>
                    <rect x="51"   y="0" width="18" height="46" rx="4" class="black-key" data-note="Ds2"/>
                    <rect x="111"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Fs2"/>
                    <rect x="141"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Gs2"/>
                    <rect x="171"  y="0" width="18" height="46" rx="4" class="black-key" data-note="As2"/>

                    <rect x="231"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Cs3"/>
                    <rect x="261"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Ds3"/>
                    <rect x="321"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Fs3"/>
                    <rect x="351"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Gs3"/>
                    <rect x="381"  y="0" width="18" height="46" rx="4" class="black-key" data-note="As3"/>

                    <rect x="441"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Cs4"/>
                    <rect x="471"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Ds4"/>
                    <rect x="531"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Fs4"/>
                    <rect x="561"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Gs4"/>
                    <rect x="591"  y="0" width="18" height="46" rx="4" class="black-key" data-note="As4"/>

                    <rect x="651"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Cs5"/>
                    <rect x="681"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Ds5"/>
                    <rect x="741"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Fs5"/>
                    <rect x="771"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Gs5"/>
                    <rect x="801"  y="0" width="18" height="46" rx="4" class="black-key" data-note="As5"/>
                </g>

                <!-- Extended piano -->
                <g id="piano-extended" transform="scale(0.575)"> <!-- Change scale to be smaller -->
                     <!-- White keys C1–B7 -->
                    <rect x="0" y="0" width="30" height="90" class="white-key" data-note="C1"/>
                    <rect x="30" y="0" width="30" height="90" class="white-key" data-note="D1"/>
                    <rect x="60" y="0" width="30" height="90" class="white-key" data-note="E1"/>
                    <rect x="90" y="0" width="30" height="90" class="white-key" data-note="F1"/>
                    <rect x="120" y="0" width="30" height="90" class="white-key" data-note="G1"/>
                    <rect x="150" y="0" width="30" height="90" class="white-key" data-note="A1"/>
                    <rect x="180" y="0" width="30" height="90" class="white-key" data-note="B1"/>

                    <rect x="210" y="0" width="30" height="90" class="white-key" data-note="C2"/>
                    <rect x="240" y="0" width="30" height="90" class="white-key" data-note="D2"/>
                    <rect x="270" y="0" width="30" height="90" class="white-key" data-note="E2"/>
                    <rect x="300" y="0" width="30" height="90" class="white-key" data-note="F2"/>
                    <rect x="330" y="0" width="30" height="90" class="white-key" data-note="G2"/>
                    <rect x="360" y="0" width="30" height="90" class="white-key" data-note="A2"/>
                    <rect x="390" y="0" width="30" height="90" class="white-key" data-note="B2"/>

                    <rect x="420" y="0" width="30" height="90" class="white-key" data-note="C3"/>
                    <rect x="450" y="0" width="30" height="90" class="white-key" data-note="D3"/>
                    <rect x="480" y="0" width="30" height="90" class="white-key" data-note="E3"/>
                    <rect x="510" y="0" width="30" height="90" class="white-key" data-note="F3"/>
                    <rect x="540" y="0" width="30" height="90" class="white-key" data-note="G3"/>
                    <rect x="570" y="0" width="30" height="90" class="white-key" data-note="A3"/>
                    <rect x="600" y="0" width="30" height="90" class="white-key" data-note="B3"/>

                    <rect x="630" y="0" width="30" height="90" class="white-key" data-note="C4"/>
                    <rect x="660" y="0" width="30" height="90" class="white-key" data-note="D4"/>
                    <rect x="690" y="0" width="30" height="90" class="white-key" data-note="E4"/>
                    <rect x="720" y="0" width="30" height="90" class="white-key" data-note="F4"/>
                    <rect x="750" y="0" width="30" height="90" class="white-key" data-note="G4"/>
                    <rect x="780" y="0" width="30" height="90" class="white-key" data-note="A4"/>
                    <rect x="810" y="0" width="30" height="90" class="white-key" data-note="B4"/>

                    <rect x="840" y="0" width="30" height="90" class="white-key" data-note="C5"/>
                    <rect x="870" y="0" width="30" height="90" class="white-key" data-note="D5"/>
                    <rect x="900" y="0" width="30" height="90" class="white-key" data-note="E5"/>
                    <rect x="930" y="0" width="30" height="90" class="white-key" data-note="F5"/>
                    <rect x="960" y="0" width="30" height="90" class="white-key" data-note="G5"/>
                    <rect x="990" y="0" width="30" height="90" class="white-key" data-note="A5"/>
                    <rect x="1020" y="0" width="30" height="90" class="white-key" data-note="B5"/>

                    <rect x="1050" y="0" width="30" height="90" class="white-key" data-note="C6"/>
                    <rect x="1080" y="0" width="30" height="90" class="white-key" data-note="D6"/>
                    <rect x="1110" y="0" width="30" height="90" class="white-key" data-note="E6"/>
                    <rect x="1140" y="0" width="30" height="90" class="white-key" data-note="F6"/>
                    <rect x="1170" y="0" width="30" height="90" class="white-key" data-note="G6"/>
                    <rect x="1200" y="0" width="30" height="90" class="white-key" data-note="A6"/>
                    <rect x="1230" y="0" width="30" height="90" class="white-key" data-note="B6"/>

                    <rect x="1260" y="0" width="30" height="90" class="white-key" data-note="C7"/>
                    <rect x="1290" y="0" width="30" height="90" class="white-key" data-note="D7"/>
                    <rect x="1320" y="0" width="30" height="90" class="white-key" data-note="E7"/>
                    <rect x="1350" y="0" width="30" height="90" class="white-key" data-note="F7"/>
                    <rect x="1380" y="0" width="30" height="90" class="white-key" data-note="G7"/>
                    <rect x="1410" y="0" width="30" height="90" class="white-key" data-note="A7"/>
                    <rect x="1440" y="0" width="30" height="90" class="white-key" data-note="B7"/>

                    <!-- C labels -->
                    <text x="15"   y="60" text-anchor="middle" class="label">C1</text>
                    <text x="225"  y="60" text-anchor="middle" class="label">C2</text>
                    <text x="435"  y="60" text-anchor="middle" class="label">C3</text>
                    <text x="645"  y="60" text-anchor="middle" class="label">C4</text>
                    <text x="855"  y="60" text-anchor="middle" class="label">C5</text>
                    <text x="1065" y="60" text-anchor="middle" class="label">C6</text>
                    <text x="1275" y="60" text-anchor="middle" class="label">C7</text>

                    <!-- Beginner labels -->
                    <text x="255" y="60" text-anchor="middle" class="label">D</text>
                    <text x="285" y="60" text-anchor="middle" class="label">E</text>
                    <text x="315" y="60" text-anchor="middle" class="label">F</text>
                    <text x="345" y="60" text-anchor="middle" class="label">G</text>
                    <text x="375" y="60" text-anchor="middle" class="label">A</text>
                    <text x="405" y="60" text-anchor="middle" class="label">B</text>

                    <!-- Black keys C1–B7 -->
                    <rect x="21"   y="0" width="18" height="46" rx="4" class="black-key" data-note="Cs1"/>
                    <rect x="51"   y="0" width="18" height="46" rx="4" class="black-key" data-note="Ds1"/>
                    <rect x="111"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Fs1"/>
                    <rect x="141"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Gs1"/>
                    <rect x="171"  y="0" width="18" height="46" rx="4" class="black-key" data-note="As1"/>

                    <rect x="231"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Cs2"/>
                    <rect x="261"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Ds2"/>
                    <rect x="321"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Fs2"/>
                    <rect x="351"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Gs2"/>
                    <rect x="381"  y="0" width="18" height="46" rx="4" class="black-key" data-note="As2"/>

                    <rect x="441"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Cs3"/>
                    <rect x="471"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Ds3"/>
                    <rect x="531"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Fs3"/>
                    <rect x="561"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Gs3"/>
                    <rect x="591"  y="0" width="18" height="46" rx="4" class="black-key" data-note="As3"/>

                    <rect x="651"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Cs4"/>
                    <rect x="681"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Ds4"/>
                    <rect x="741"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Fs4"/>
                    <rect x="771"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Gs4"/>
                    <rect x="801"  y="0" width="18" height="46" rx="4" class="black-key" data-note="As4"/>

                    <rect x="861"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Cs5"/>
                    <rect x="891"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Ds5"/>
                    <rect x="951"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Fs5"/>
                    <rect x="981"  y="0" width="18" height="46" rx="4" class="black-key" data-note="Gs5"/>
                    <rect x="1011" y="0" width="18" height="46" rx="4" class="black-key" data-note="As5"/>

                    <rect x="1071" y="0" width="18" height="46" rx="4" class="black-key" data-note="Cs6"/>
                    <rect x="1101" y="0" width="18" height="46" rx="4" class="black-key" data-note="Ds6"/>
                    <rect x="1161" y="0" width="18" height="46" rx="4" class="black-key" data-note="Fs6"/>
                    <rect x="1191" y="0" width="18" height="46" rx="4" class="black-key" data-note="Gs6"/>
                    <rect x="1221" y="0" width="18" height="46" rx="4" class="black-key" data-note="As6"/>

                    <rect x="1281" y="0" width="18" height="46" rx="4" class="black-key" data-note="Cs7"/>
                    <rect x="1311" y="0" width="18" height="46" rx="4" class="black-key" data-note="Ds7"/>
                    <rect x="1371" y="0" width="18" height="46" rx="4" class="black-key" data-note="Fs7"/>
                    <rect x="1401" y="0" width="18" height="46" rx="4" class="black-key" data-note="Gs7"/>
                    <rect x="1431" y="0" width="18" height="46" rx="4" class="black-key" data-note="As7"/>
                </g>
            </svg>
            </div>
        </div>
        </section>

        <br> <!-- Gap -->

        <!-- Autoplay editor -->
        <section class="controls-card card shadow-sm mb-4">
            <div class="card-body">
                <div class="d-grid align-items-center" style="grid-template-columns: 1fr auto 1fr;">
                    <!-- Left (tempo) -->
                    <div class="tempo-left text-start">
                    <label class="text-light">
                        Tempo
                        <input id="tempo" type="range" min="0" max="2" step="0.1" value="1">
                    </label>
                    <span class="text-light" id="tempoVal">1x</span>
                    </div>

                    <!-- Center (play) -->
                    <div class="transport text-center">
                        <!-- Rewind -->
                        <button class="btn btn-outline-light mx-2" id="rewind" onclick="rewind();"><i class="bi bi-skip-backward-fill"></i></button>
                        <!-- Play / pause toggle -->
                        <button class="btn btn-outline-light mx-2" id="pause" onclick="togglePause();"><i class="bi bi-play-fill"></i></button>
                        <!-- Stop -->
                        <button class="btn btn-outline-light mx-2" id="stop" onclick="stopAll();"><i class="bi bi-stop-fill"></i></button>
                        <!-- Fast forward -->
                        <button class="btn btn-outline-light mx-2" id="forward" onclick="fastForward();"><i class="bi bi-skip-forward-fill"></i></button>
                    </div>

                    <!-- Right (extend) -->
                    <div>
                        <div class="form-check form-switch mt-2 d-flex gap-2 justify-content-end">
                            <input class="form-check-input" type="checkbox" id="toggleExtended">
                            <label class="form-check-label" for="toggleExtended">Extend piano</label>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Controls (for autoplay) -->
        <section class="controls-card card shadow-sm mb-4">
        <div class="card-body">
            <div class="row g-3 align-items-center">
                <!-- Checkbox for piano note labels -->
                <div class="col-12 col-md-4">
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="toggle-labels" checked>
                        <label class="form-check-label" for="toggle-labels">Show note labels</label>
                    </div>
                </div>
                <!-- Additional info -->
                <div class="col-12 col-md-8 text-md-end">
                    <span class="form-check-label">Autoplay mode:</span>
                    <span class="badge bg-light text-dark">Use + for chords</span>
                    <span class="badge bg-light text-dark">Use _ to add waits</span>
                </div>
            </div>

            <hr class="my-1"> <!-- Gap -->

            <!-- Form input -->
            <div class="mb-3">
                <label for="musicSelect" class="form-label">Choose from preset list of music</label>
                <select id="musicSelect" class="form-select">
                    <option value="">-- Select music --</option>
                </select>
            </div>
            <div class="row g-3">
                <div class="col-12 col-lg-6">
                    <label for="noteInputLeft" class="form-label">Left hand notes</label>
                    <input type="text" id="noteInputLeft" class="form-control" placeholder="e.g., C3,E3_F3+G3__">
                </div>
                <div class="col-12 col-lg-6">
                    <label for="noteInputRight" class="form-label">Right hand notes</label>
                    <input type="text" id="noteInputRight" class="form-control" placeholder="e.g., C4,F4,E4_,G4+G5__">
                </div>
            </div>

            <hr class="my-2"> <!-- Gap -->

            <!-- Buttons -->
            <div class="row g-3">
                <div class="col-12 col-lg-6 mt-3 d-flex gap-2">
                    <label for="midiFile" class="form-label">Upload MIDI file</label>
                    <input class="text-light" type="file" id="midiFile" accept=".mid,.midi">
                </div>
                <div class="col-12 col-lg-6 mt-3 d-flex gap-2 justify-content-end"> <!-- Set to right -->
                    <button class="btn btn-primary" id="play" onclick="autoPlay(); location.href='#autoplay-section';">Start autoplay</button>
                    <button class="btn btn-outline-primary" id="clear" onclick="clearAutoPlay();">Clear</button>
                </div>
            </div>
        </div>
        </section>
    </main>

    <br>
    <footer>
    <p>© 2025 Callum O'Prey</p>
    </footer>

    <!-- Javascript files -->
    <script src="script.js"></script>
    <script src="midi-upload.js"></script>
</body>
</html>